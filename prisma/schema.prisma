// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id            Int           @id @default(autoincrement())
  fullName      String?
  username      String        @unique
  email         String        @unique
  password_hash String
  role          String?       @default("author") // e.g., 'author', 'reviewer', 'admin', 'reviewer_inactive'
  manuscripts   Manuscript[]  @relation("SubmittedBy")
}

model Manuscript {
  id                      String    @id @default(cuid())
  articleTitle            String
  abstract                String
  keywords                String?
  isSpecialReview         Boolean   @default(false)
  
  // File tracking
  coverLetterFileName     String?
  manuscriptFileName      String
  supplementaryFilesName  String?
  
  // Author and agreement
  authorAgreement         Boolean   @default(false)
  coAuthors               Json?     // Storing co-author list as JSON

  // Status and tracking
  status                  String    @default("Submitted") // e.g., 'Submitted', 'In Review', 'Accepted', 'Published', 'Rejected', 'Suspended'
  submittedAt             DateTime  @default(now())
  publishedAt             DateTime?
  views                   Int       @default(0)
  downloads               Int       @default(0)
  citations               Int       @default(0)

  // Relationships
  submittedById           Int
  submittedBy             User      @relation("SubmittedBy", fields: [submittedById], references: [id])
  
  journalCategoryId       String
  journalCategory         JournalCategory @relation(fields: [journalCategoryId], references: [id])
}

model JournalCategory {
  id                      String @id @default(cuid())
  name                    String @unique
  slug                    String @unique
  description             String @default("")
  
  // Icon and Image - stored as strings
  iconName                String // e.g., "FlaskConical", "Library"
  imagePath               String
  imageHint               String

  // Metadata
  abbreviation            String?
  language                String?
  issn                    String?
  doiBase                 String?
  startYear               Int?
  displayIssn             String?
  copyrightYear           Int?

  manuscripts             Manuscript[]
}
